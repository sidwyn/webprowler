<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>WebProwler</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div id="app">
      <!-- Header -->
      <header class="header">
        <h1 class="header-logo">
          <svg width="16" height="16" viewBox="0 0 18 18" fill="none" aria-hidden="true">
            <circle cx="9" cy="9" r="7" stroke="#60a5fa" stroke-width="1.5"/>
            <circle cx="9" cy="9" r="2.2" fill="#60a5fa"/>
            <line x1="9" y1="1" x2="9" y2="5.2" stroke="#60a5fa" stroke-width="1.5" stroke-linecap="round"/>
            <line x1="9" y1="12.8" x2="9" y2="17" stroke="#60a5fa" stroke-width="1.5" stroke-linecap="round"/>
            <line x1="1" y1="9" x2="5.2" y2="9" stroke="#60a5fa" stroke-width="1.5" stroke-linecap="round"/>
            <line x1="12.8" y1="9" x2="17" y2="9" stroke="#60a5fa" stroke-width="1.5" stroke-linecap="round"/>
          </svg>
          WebProwler
        </h1>
        <div class="header-actions">
          <span id="provider-badge" class="provider-badge hidden"></span>
          <button id="recordings-btn" class="icon-btn hidden" title="Recordings">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polygon points="10 8 16 12 10 16 10 8" fill="currentColor" stroke="none"/></svg>
          </button>
          <button id="settings-btn" class="icon-btn" title="Settings">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>
          </button>
        </div>
      </header>

      <!-- Active tab bar -->
      <div id="tab-bar" class="tab-bar">
        <span class="tab-bar-dot"></span>
        <img id="tab-favicon" class="tab-bar-favicon hidden" alt="" />
        <span id="tab-title" class="tab-bar-title">No active tab</span>
      </div>

      <!-- Settings Panel -->
      <div id="settings-panel" class="panel hidden">
        <h2>Settings</h2>
        <label class="field">
          <span>Provider</span>
          <select id="llm-provider">
            <option value="anthropic">Anthropic (Claude)</option>
            <option value="openai">OpenAI</option>
            <option value="gemini">Google Gemini</option>
            <option value="ollama">Ollama (local)</option>
            <option value="custom">Custom (OpenAI-compatible)</option>
          </select>
        </label>
        <label class="field">
          <span
            >API Key
            <a
              id="api-key-link"
              href="#"
              target="_blank"
              class="field-link hidden"
              >Get key ↗</a
            ></span
          >
          <input type="password" id="api-key" placeholder="sk-..." />
        </label>
        <label class="field">
          <span>Model</span>
          <select id="model-name">
            <option value="">Select a model…</option>
          </select>
        </label>
        <label class="field hidden" id="base-url-field">
          <span>Base URL (optional)</span>
          <input
            type="text"
            id="base-url"
            placeholder="https://api.openai.com/v1"
          />
        </label>
        <button id="save-settings" class="btn btn-primary">Save</button>
      </div>

      <!-- Recordings Panel -->
      <div id="recordings-panel" class="panel recordings-panel hidden">
        <h2>Recorded Tasks</h2>
        <div id="recordings-list"></div>
      </div>

      <!-- Chat area -->
      <div id="chat" class="chat">
        <div id="messages" class="messages">
          <!-- Welcome card (removed after first task or dismiss) -->
          <div id="welcome" class="welcome-card">
            <h2>Welcome to WebProwler</h2>
            <ol class="welcome-steps">
              <li>
                <span class="welcome-step-num">1</span>
                <span
                  >Click ⚙️ and add your API key (Anthropic, OpenAI, or any
                  provider)</span
                >
              </li>
              <li>
                <span class="welcome-step-num">2</span>
                <span>Navigate to any webpage in this tab</span>
              </li>
              <li>
                <span class="welcome-step-num">3</span>
                <span
                  >Describe what you want to do —
                  <strong>"search for X"</strong>,
                  <strong>"fill in the form"</strong>,
                  <strong>"click sign in"</strong></span
                >
              </li>
            </ol>
            <button class="dismiss-btn" id="dismiss-welcome">Got it</button>
          </div>
        </div>
      </div>

      <!-- Status bar -->
      <div id="status-bar" class="status-bar hidden">
        <span id="status-text"></span>
        <span id="token-count" class="token-count"></span>
      </div>

      <!-- Input -->
      <div class="input-area">
        <textarea
          id="task-input"
          placeholder="What should I do on this page?"
          rows="1"
        ></textarea>
        <div class="input-actions">
          <span class="input-hint"
            ><kbd>⏎</kbd> send &nbsp;<kbd>↑</kbd><kbd>↓</kbd> history</span
          >
          <div class="input-btns">
            <button id="send-btn" class="btn btn-primary">Send</button>
            <button id="stop-btn" class="btn btn-danger hidden">Stop</button>
          </div>
        </div>
      </div>
    </div>

    <script src="app.js" type="module"></script>
  </body>
</html>
